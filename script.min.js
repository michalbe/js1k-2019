var h = 2 * Math.PI, l = [~~(255 * Math.random()), ~~(255 * Math.random()), ~~(255 * Math.random())]; function m(a) { this.j = []; this.B = 1; this.height = this.width = 0; Object.assign(this, a) } function n(a, b) { var c = p; a |= 0; b |= 0; return 0 > a || a >= c.width || 0 > b || b >= c.height ? -1 : c.j[b * c.width + a] } function q(a, b, c, f, g) { if (0 === b) return { h: Infinity }; var d = 0 < b ? ~~(c + 1) - c : Math.ceil(c - 1) - c; a = d * a / b; return { x: g ? f + a : c + d, y: g ? c + d : f + a, h: d * d + a * a } }
function r(a, b, c, f, g, d, e, k) { c = (b.y - (0 > k ? f : 0) | 0) * a.width + (b.x - (0 > e ? c : 0) | 0); b.o = 0 > c || c >= a.j.length ? -1 : a.j[c]; b.c = g + Math.sqrt(b.h); b.F = 0; b.offset = d - (d | 0); return b } m.prototype = { m: function (a, b, c, f) { f = void 0 === f ? !1 : f; var g = [], d = Math.sin(b); b = Math.cos(b); var e = { x: a.x, y: a.y, o: 0, c: 0 }; do { g.push(e); if (!f && 0 < e.o) break; a = q(d, b, e.x, e.y); var k = q(b, d, e.y, e.x, !0); e = a.h < k.h ? r(this, a, 1, 0, e.c, a.y, b, d) : r(this, k, 0, 1, e.c, k.x, b, d) } while (e.c <= c); return g } };
function t() { this.A = .4 * Math.PI; this.D = 14; this.C = 5; this.p = { x: 0, y: 0 }; this.dir = .5 * Math.PI; Object.assign(this, void 0); this.s = this.width / this.i } t.prototype = {}; function u() { var a = { width: 640, height: 360, g: v }; this.width = 640; this.height = 360; this.i = 30; this.g = document.createElement("canvas"); Object.assign(this, a); this.g.width = this.width; this.g.height = this.height; this.a = this.g.getContext("2d"); this.s = this.width / this.i } u.prototype = { m: function (a, b, c) { return this.map ? this.map.m(a, b, c) : [] } };
var v = document.getElementById("canvas"), w = v.getContext("2d"), x = -1, p = new m({ width: 20, height: 22, B: 2, j: "e13wtdmn7n079tsf7qy20naz7gcepyazc0z1tcvvautqjrrrax1ppc9rbcytdccxd33098ltc02ythhxcevfb01r".split("").reduce(function (a, b, c) { a[x]; 0 === c % 8 && (x++ , a[x] = ""); a[x] += b; return a }, []).map(function (a) { return parseInt(a, 36).toString(2) }).join("").split("") }), y = new t, z = new u;
function A() { this.w = { 37: "l", 39: "r", 38: "f", 40: "b" }; this.v = { l: !1, r: !1, f: !1, b: !1 }; document.addEventListener("keydown", this.u.bind(this, !0), !1); document.addEventListener("keyup", this.u.bind(this, !1), !1) } A.prototype.u = function (a, b) { var c = this.w[b.keyCode]; c && (this.v[c] = a, b.preventDefault && b.preventDefault(), b.stopPropagation && b.stopPropagation()) }; var B = new A, C = 2.8, D = 3.7, E = .3 * Math.PI; function F(a) { var b = Math.cos(E) * a; a *= Math.sin(E); 0 >= n(C + b, D) && (C += b); 0 >= n(C, D + a) && (D += a); y.p.x = C; y.p.y = D } y.dir = E;
y.p.x = C; y.p.y = D; var G = 0;
function H(a) {
    var b, c = (a - G) / 1E3; G = a; if (.2 > c) {
        a = B.v; a.l && (E = (E + -Math.PI * c + h) % h, y.dir = E); a.r && (E = (E + Math.PI * c + h) % h, y.dir = E); a.f && F(3 * c); a.b && F(-3 * c); v.width = v.width; z.a.save(); for (c = 0; c < z.i; c++) {
            a = y.A * (c / z.i - .5); var f = p.m(y.p, y.dir + a, y.D), g = c, d = f; var e = a; a = z; var k = y; f = ~~(g * a.s); var I = Math.ceil(a.s); for (b = -1; ++b < d.length && 0 >= d[b].o;); b < d.length && (a.a.save(), d = d[b], g = "JS1K"[g % 4], e = d.c * Math.cos(e), b = 1 * a.height / e, e = a.height / 2 * (1 + 1 / e) - b, a.a.globalAlpha = 1, a.a.fillStyle = "rgba(" + l[0] + ", " + l[1] + ", " + l[2] + ", " +
                (1 - Math.max((d.c + d.F) / k.C, 0)) + ")", w.font = b + "px Arial", k = I / a.a.measureText(g).width, a.a.scale(k, 1), w.fillText(g, f / k, e + b), a.a.restore())
        } z.a.restore()
    } requestAnimationFrame(H)
} H();
